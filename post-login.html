<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Redirecting…</title>
</head>

<body>
<script type="module">
import { supabase } from "./js/config.js";
import { ensureProfile, checkBanStatus } from "./js/auth.js";

// Get current session after OAuth login
const { data: session } = await supabase.auth.getSession();

// If login failed → go back
if (!session.session) {
    window.location.href = "login.html";
}

// Create or load user DB profile
await ensureProfile(session.session.user);

// Check if banned (auto logs out if banned)
await checkBanStatus(session.session.user.id);

// If allowed, go to dashboard
window.location.href = "dashboard.html";
</script>
</body>
</html>
